# «Управление доступом» 

### Задание 1

Создайте конфигурацию для подключения пользователя

*Создайте и подпишите SSL-сертификат для подключения к кластеру.*

*Настройте конфигурационный файл kubectl для подключения.*

*Создайте роли и все необходимые настройки для пользователя.*

*Предусмотрите права пользователя. Пользователь может просматривать логи подов и их конфигурацию (kubectl logs pod <pod_id>, kubectl describe pod <pod_id>).*

*Предоставьте манифесты и скриншоты и/или вывод необходимых команд.*


Используя OpenSSL создаем файл ключа: 

![](img/1.png)

Создадим запрос на подписание сертификата (CSR): 

![](img/2.png)

Генеририм файл сертификата (CRT). Будем использовать ключи кластера по пути /var/snap/microk8s
current/certs/: 

![](img/3.png)

#### Настраиваем конфигурационный файл kubectl для подключения.


Создаем пользователя staff и настраиваем его на использование созданного ранее ключа:

![](img/4.png)

Создаем новый контекст с именем staff-context и подключаю его к пользователю staff, созданному ранее: 

![](img/5.png)

Проверяем, создался ли контекст: 

![](img/6.png)


#### Создаем роли и необходимые настройки для пользователя

Создаем отдельный Namespace:

![](img/7.png)

![](img/8.png)

Включаем RBAC контроллер:

![](img/9.png)

Применим манифест создания роли (Role) и манифест привязки роли к Namespace (RoleBinding): 

![](img/10.png)
 
![](img/11.png)

![](img/12.png)

 **Проверим права пользователя**

Переключимся в контекст пользователя:

![](img/13.png)

Развернем Deployment в разрешенном для пользователя Namespace: 

![](img/14.png)

![](img/15.png)



Проверим какие поды развернуты в Namespace с именем default: 

![](img/16.png)


В default Namespace нет доступа, так как он не был указан в манифесте Role.
 
Теперь, проверим поды в Namespace с именем access-control:

![](img/17.png)

Отобразился список подов.

Проверим логи пода:





Ссылка на манифесты:










 
 









